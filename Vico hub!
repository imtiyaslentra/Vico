local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local VirtualInputManager = game:GetService("VirtualInputManager")
local BallFolder = Workspace:WaitForChild("Balls")

local camera = Workspace.CurrentCamera

local player = Players.LocalPlayer
local canParry = true
local canSpam = false
local Titan_blade = false
local Predict_parry = true
local Parry_mode = "pro hard"
local parry_method = "Firesignal"
local config_1 = BallFolder -- Jika BallFolder adalah objek
local config_2 = SpamFolder -- Jika SpamFolder adalah objek
local calculate_1_2 = true
local autofarm = false
local ai_play = false
local ai_farm_rage = false
local no_delay = false
local ai_chat = false
local afk_mode = false
local idgaf_mode = true
local skid_fade = false
local AutoWalk = false
local AutoWalkDistanceX = 0 -- Atur nilai default
local AutoWalkDistanceZ = 0 -- Atur nilai default
local AutoDoubleJump = false
local AutoRealWalk = false
local ClosestPlayer_var = false
local ballaim = false
local RandomTeleports = false
local TeleportDistanceX = 0 -- Atur nilai default
local TeleportDistanceZ = 0 -- Atur nilai default
local CanSlash = false
local BallSpeed = 0

if idgaf_mode then
    skid_fade = true
end

local success, err = pcall(function()
    local OrionLib = loadstring(game:HttpGet("https://raw.githubusercontent.com/shlexware/Orion/main/source"))()
    if OrionLib then
        print("OrionLib loaded successfully")
    else
        error("OrionLib is nil")
    end
end)

if not success then
    print("Error: " .. err)
end

if not success then
    print("Error loading OrionLibrary: " .. err)
end

local Window = OrionLib:MakeWindow({Name = "Vico Hub (Just Noob)", IntroText = "Vico Hub", HidePremium = false})

-- Membuat Tab
local Tab = Window:MakeTab({
    Name = "Main",
    Icon = "rbxassetid://4483345998",
    PremiumOnly = false
})

-- Toggle untuk Auto Parry
Tab:AddToggle({
    Name = "Auto Parry",
    Default = false,
    Callback = function(Value)
        canParry = Value
        if Value then
            print("Auto Parry Enabled")
        else
            print("Auto Parry Disabled")
        end
    end    
})

-- Variabel untuk menyimpan status
local AutoWalk = false
local PlayerSaftey = false
local BaseDistance = 0

-- Toggle untuk Auto Walk
local AutoWalkToggle = Tab:AddToggle({
    Name = "Auto Walk",
    Default = false,
    Callback = function(Value)
        AutoWalk = Value
        if AutoWalk then
            print("Auto Walk Enabled")
        else
            print("Auto Walk Disabled")
        end
    end
})

-- Slider untuk Parry Base Distance
local BaseDistanceSlider = Tab:AddSlider({
    Name = "Parry Base Distance",
    Min = 0,
    Max = 100,
    Default = 0,
    Callback = function(Value)
        BaseDistance = Value
        print("Base Distance set to: " .. BaseDistance)
    end
})

-- Toggle untuk Player Safety
local PlayerSafetyToggle = Tab:AddToggle({
    Name = "Player Safety",
    Default = false,
    Callback = function(Value)
        PlayerSaftey = Value
        if PlayerSaftey then
            print("Player Safety Enabled")
        else
            print("Player Safety Disabled")
        end
    end
})

BaseDistance = 0
Ragebot.Slider("Parry Base Distance", 0, 100, BaseDistance, function(t)
    BaseDistance = t
end)

AutoWalk = false
Ragebot.Toggle("Auto Walk", AutoWalk, function(t)
    AutoWalk = t
end)

AutoDoubleJump = false
Ragebot.Toggle("Auto Jump", AutoDoubleJump, function(t)
    AutoDoubleJump = t
end)

AutoRealWalk = false
Ragebot.Toggle("Realistic Auto Walk", AutoRealWalk, function(t)
    AutoRealWalk = t
end)

PlayerSaftey = false
Ragebot.Toggle("Player Saftey", PlayerSaftey, function(t)
    PlayerSaftey = t
end)

PlayerSaftey_Distance = 10
Ragebot.Slider("Player Saftey Distance", 0, 50, PlayerSaftey_Distance, function(v)
    PlayerSaftey_Distance = v
end)

local can_Execute = false

if can_Execute then
    print("executed!")
    spawn(function()
        while task.wait() do
            pcall(function()
                if ws then
                    game.Players.LocalPlayer.Character.Humanoid.WalkSpeed = getgenv().WalkSpeed_Mana
                end
            end)
        end
    end)
end

AutoWalkDistanceX = 12
Ragebot.Slider("Auto Walk Distance X", -40, 40, AutoWalkDistanceX, function(t)
    AutoWalkDistanceX = t
end)

AutoWalkDistanceZ = 13
Ragebot.Slider("Auto Walk Distance Z", -40, 40, AutoWalkDistanceZ, function(t)
    AutoWalkDistanceZ = t
end)

ballaim = false
Ragebot.Toggle("Aim At The Ball", ballaim, function(t)
    ballaim = t
end)

ClosestPlayer_var = false
Ragebot.Toggle("Aim At Closest Player", ClosestPlayer_var, function(t)
    ClosestPlayer_var = t
end)

RandomTeleports = false
Ragebot.Toggle("Random Teleports", RandomTeleports, function(t)
    RandomTeleports = t
end)

TeleportDistanceX = 0
Ragebot.Slider("Teleport Distance X", -40, 40, TeleportDistanceX, function(t)
    TeleportDistanceX = t
end)

TeleportDistanceZ = 0
Ragebot.Slider("Teleport Distance Z", -40, 40, TeleportDistanceZ, function(t)
    TeleportDistanceZ = t
end)

function GetMouse()
    local UserInputService = game:GetService("UserInputService")
    return UserInputService:GetMouseLocation()  -- Ensure this is the correct method for your setup
end

function GetClosestPlayer()
    local closestDistance = math.huge
    local closestTarget = nil
    for _, v in pairs(game:GetService("Workspace").Alive:GetChildren()) do
        if v and v:FindFirstChild("HumanoidRootPart") and v ~= game.Players.LocalPlayer.Character then
            local humanoidRootPart = v.HumanoidRootPart
                local distance = (game.Players.LocalPlayer.Character.HumanoidRootPart.Position - v.HumanoidRootPart.Position).Magnitude --(Vector2.new(viewportPoint.X, viewportPoint.Y) - mousePos).magnitude
                if distance < closestDistance then
                    closestDistance = distance
                    closestTarget = v
                end
        end
    end
    return closestTarget
end

spawn(function()
    while task.wait() do
        if PlayerSaftey then
            if game.Players.LocalPlayer.Character.Parent.Name == "Dead" then return end
            pcall(function()
                if (GetClosestPlayer().HumanoidRootPart.Position - game.Players.LocalPlayer.Character.HumanoidRootPart.Position).Magnitude <= PlayerSaftey_Distance then
                    game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = GetClosestPlayer().HumanoidRootPart.CFrame * CFrame.new(-PlayerSaftey_Distance, 0, -PlayerSaftey_Distance)
                end
            end)
        end
    end
end)

function GetBall()
    for i,v in pairs(game:GetService("Workspace").Balls:GetChildren()) do
        if v:IsA("Part") then
            return v
        end
    end
    return nil
end

function GetBallfromplayerPos(Ball)
    return (Ball.Position - game.Players.LocalPlayer.Character.HumanoidRootPart.Position).Magnitude
end

local function getSpeed(part)
local function getSpeed(part)
    if part:IsA("BasePart") then
        local speed = part.Velocity.Magnitude
        if speed > 1 then
            return part, speed
        end
        return nil, nil
    else
        print("The provided instance is not a BasePart.")
        return nil, nil
    end
end

local function measureVerticalDistance(humanoidRootPart, targetPart)
    if humanoidRootPart:IsA("BasePart") and targetPart:IsA("BasePart") then
        local humanoidRootPartY = humanoidRootPart.Position.Y
        local targetPartY = targetPart.Position.Y
        local verticalDistance = math.abs(humanoidRootPartY - targetPartY)
        return verticalDistance
    else
        print("Both humanoidRootPart and targetPart must be BaseParts.")
        return nil
    end
end

function GetHotKey()
	for i,v in pairs(game.Players.LocalPlayer.PlayerGui.Hotbar.Block.HotkeyFrame:GetChildren()) do
		if v:IsA("TextLabel") then
			return v.Text
		end
	end
	return ""
end

local text = game.Players.LocalPlayer.PlayerGui.Hotbar.Block.HotkeyFrame.F
local KeyCodeBlock = text.Text
text:GetPropertyChangedSignal("Text"):Connect(function()
    KeyCodeBlock = text.Text
end)

-- Definisi fungsi getSpeed
local function getSpeed(part)
    -- Implementasikan logika untuk menghitung kecepatan
    local speed = part.Velocity.Magnitude -- Contoh: hitung kecepatan
    return part, speed -- Kembalikan nilai part dan speed
end

-- Definisi fungsi GetClosestPlayer
local function GetClosestPlayer()
    local closestPlayer = nil
    local closestDistance = math.huge

    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= Players.LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local distance = (player.Character.HumanoidRootPart.Position - Players.LocalPlayer.Character.HumanoidRootPart.Position).Magnitude
            if distance < closestDistance then
                closestDistance = distance
                closestPlayer = player
            end
        end
    end
    return closestPlayer
end

-- Fungsi untuk parry
local function parry()
    if canParry then
        canParry = false
        VirtualInputManager:SendMouseButtonEvent(0, 0, 0, true, game, 0) -- Menekan tombol mouse
        VirtualInputManager:SendMouseButtonEvent(0, 0, 0, false, game, 0) -- Melepaskan tombol mouse
        
        task.delay(0.1, function()
            print("Parried successfully!")
            canParry = true 
        end)
    end
end

spawn(function()
    while task.wait() do
        parry()
    end
end)

-- Loop utama untuk mendeteksi bola
while task.wait() do
    for _, v in pairs(game:GetService("Workspace").Balls:GetChildren()) do
        if v:IsA("Part") then
            if not game.Players.LocalPlayer.Character:FindFirstChild("Highlight") then return end
            local part, speed = getSpeed(v)
            if part and speed then
                local minDistance = 2.5 * (speed * 0.1) + 2
                if minDistance <= 20 then
                    BallSpeed = 23
                elseif minDistance <= 88 then
                    BallSpeed = 2.5 * (speed * 0.1) + 5
                elseif minDistance <= 110 then
                    BallSpeed = 90
                end

                if (game.Players.LocalPlayer.Character.HumanoidRootPart.Position - part.Position).Magnitude <= BallSpeed then
                    CanSlash = true
                else
                    CanSlash = false
                end
            end
        end
    end

    if CanSlash then
        if math.random(1, 5) == 5 then
            game:GetService("VirtualInputManager"):SendMouseButtonEvent(0, 0, 0, true, game, 1)
        else
            game:GetService("VirtualInputManager"):SendKeyEvent(true, Enum.KeyCode[KeyCodeBlock], false, game)
        end
        CanSlash = false
    end
end

-- Fungsi untuk AutoWalk
spawn(function()
    while task.wait() do
        if AutoWalk then
            pcall(function()
                if game.Players.LocalPlayer.Character.Parent.Name == "Dead" then return end
                for _, v in pairs(game:GetService("Workspace").Balls:GetChildren()) do
                    if v:IsA("Part") then
                        local part, speed = getSpeed(v)
                        if part and speed then
                            if speed > 5 then
                                if not game.Players.LocalPlayer.Character:FindFirstChild("Highlight") then
                                    game.Players.LocalPlayer.Character.Humanoid:MoveTo(part.Position + Vector3.new(AutoWalkDistanceX, 0, AutoWalkDistanceZ))
                                else
                                    for _, alivePlayer in pairs(game:GetService("Workspace").Alive:GetChildren()) do
                                        if alivePlayer ~= game.Players.LocalPlayer.Character then
                                            game.Players.LocalPlayer.Character.Humanoid:MoveTo(alivePlayer.HumanoidRootPart.Position + Vector3.new(AutoWalkDistanceX, 0, AutoWalkDistanceZ))
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end)
        end
        if AutoDoubleJump then
            pcall(function()
                game:GetService("VirtualInputManager"):SendKeyEvent(true, Enum.KeyCode.Space, false, game)
            end)
        end
    end
end)

-- Loop untuk AutoRealWalk
spawn(function()
    while task.wait() do
        if AutoRealWalk then
            pcall(function()
                if game.Players.LocalPlayer.Character.Parent.Name == "Dead" then return end
                for _, v in pairs(game:GetService("Workspace").Balls:GetChildren()) do
                    if v:IsA("Part") then
                        local part, speed = getSpeed(v)
                        if part and speed then
                            if speed > 5 then
                                wait(math.random(1, 5))
                                game.Players.LocalPlayer.Character.Humanoid:MoveTo(game.Players.LocalPlayer.Character.PrimaryPart.Position + Vector3.new(AutoWalkDistanceX + math.random(-50, 50), 0, AutoWalkDistanceZ + math.random(-50, 50)))
                            end
                        end
                    end
                end
            end)
        end
    end
end)

-- Loop untuk melihat pemain terdekat
spawn(function()
    while task.wait() do
        if ClosestPlayer_var then
            pcall(function()
                if game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character.Parent.Name == "Dead" then return end
                
                local ClosestPlayer = GetClosestPlayer()
                if ClosestPlayer and ClosestPlayer:FindFirstChild("Head") then
                    workspace.CurrentCamera.CFrame = CFrame.new(workspace.CurrentCamera.CFrame.Position, ClosestPlayer.Head.Position)
                end
            end)
        end
    end
end)

-- Loop untuk mengarahkan kamera ke bola
spawn(function()
    while task.wait() do
        if ballaim then
            pcall(function()
                if game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character.Parent.Name == "Dead" then return end
                
                local OldCameraFrame = workspace.CurrentCamera.CFrame
                for _, v in pairs(game:GetService("Workspace").Balls:GetChildren()) do
                    if v:IsA("Part") then
                        workspace.CurrentCamera.CFrame = CFrame.new(OldCameraFrame.Position, v.Position)
                    end
                end
            end)
        end
    end
end)

-- Loop untuk teleport acak
spawn(function()
    while task.wait(math.random(1, 2)) do
        if RandomTeleports then
            pcall(function()
                if game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character.Parent.Name == "Dead" then return end
                
                for _, v in pairs(game:GetService("Workspace").Balls:GetChildren()) do
                    if v:IsA("Part") then
                        local part, speed = getSpeed(v)
                        if part then
                            game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = part.CFrame * CFrame.new(TeleportDistanceX, 0, TeleportDistanceZ)
                        end
                    end
                end
            end)
        end
    end
end)

OrionLib:Init() -- Menginisialisasi Orion Library
